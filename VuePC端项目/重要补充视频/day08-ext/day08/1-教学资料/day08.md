## PC-day08

### 1.0 概述

#### 1.1 复习

+ 评论列表
  + 组件&路由&入口
  + 静态页面
  + 动态请求接口数据
  + 将数据渲染到页面上
  + 点击开启&关闭评论

+ 素材管理
  + 组件&路由&入口
  + 静态页面
  + 定义了加载数据的方法
    + 点击全部加载所有的素材
    + 点击收藏加载收藏后的素材
  + 点击星星
    + 收藏素材
    + 取消收藏
  + 点击垃圾桶
    + 删除素材
  + 上传素材
    + 完成页面的布局
    + 使用上传组件完成上传

+ 帐户信息
  + 组件&路由&入口
  + 静态页面
  + 渲染用户的信息到页面上
  + 修改用户信息
  + vuex
    + 是什么
      + vue 中提供一个状态管理工具
    + 有什么用
      + 用来管理 vue 项目一些被多个组件使用的公共的数据
    + 总结：
      + vuex 是一个仓库用来统一管理项目中的共用数据
    + 步骤：
      + 1）下载
      + 2）引入
      + 3）创建一个 store 对象
      + 4）定义属性：
        + state：项目中的公用数据
        + mutations：修改 state 中的数据
      + 5）将 store 挂载到 vue 实例中
      + 6）使用 vuex
        + 使用数据
          + this.$store.state.xxx
        + 调用方法
          + this.$store.commit('xxx', xxx)
  + 将用户信息保存到 vuex 中
    + 一旦用户信息发生改变直接在 vuex 中更新数据
    + 在 vuex 中更新 localstore 中的数据
  + 修改用户头像
    + 问题1：接收给出的请求方式为 patch ，而 上传组件默认为 post
    + 方案1：使用自定义方法来覆盖默认的上传行为
    + 问题2：由于 axios 底层是用 XMLHttpRequest 来实现的，无法直接上传文件。如果使用 axios 来上传文件会直接报错
    + 方案2：在使用 axios 上传文件时，将文件数据使用 fromData 对象来进行包装

#### 1.2 今日内容

+ 完成发布文章中的封面功能
+ 在 vue 中使用 echars
+ 项目的打包
+ 打包的原理：webpack



### 2.0 功能

#### 2.1 封面

##### 2.1.1 功能预览

+ 显示四个单选框：单图&三图&无图&自动
  + 当选择单图时，下方出现一个图片选择器
  + 当选择三图上时，下方出现三个图片选择器
  + 当选择无图&自动时，下方没有图片选择器
+ 点击图片选择器
  + 打开一个新的面板
    + 加载了素材库
      + 全部
      + 收藏
    + 上传图片

##### 2.1.2 放置四个单选择按钮

+ 根据单选框按钮设置图片选择器
+ 完成对应的样式

##### 2.1.3 点击选择器打开一个弹框

+ 给选择器添加点击事件
+ 在事件中打开弹框
  + 使用 tab 选项完成
    + 素材库
      + 全部
      + 收藏
    + 上传图片
  + 点击素材选项时，给元素添加一个加粗的边框
    + 给元素添加点击事件
    + 点击完成之后添加边框

#### 2.2 在 vue-cli 搭建的项目中使用 echars

+ 基本概念：

  + 什么是 echars
    + 由百度公司出品的一个数据可视化框架
    + 后期由 apach 收购
  + 作用：
    + 用来将数据以图表的形式进行显示

+ 使用：

  + tip:

    + vue-cli 是一个 vue 的脚手架工具，用来生成项目结构
    + vue-cli 底层是用 webpack
    + 如果要在 vue-cli 中使用 echars 相当于是在 webpack 中的使用

  + 步骤：

    + 1）安装 EChars

      ```
      npm install echarts --save
      ```

    + 2）导入ECharts

      ```
      import echarts from 'echarts'
      ```

    + 3）添加一个渲染 echarts 的容器

      + 这个容器必须设置宽和高

      ```
      <div id="container"></div>
      ```

    + 4）初始化 echarts

      ```
      var myChart = echarts.init(document.getElementById('container'));
      // 设置 echarts 中的属性
      myChart.setOption({
          title: {
              text: 'ECharts 入门示例'
          },
          tooltip: {},
          xAxis: {
              data: ['衬衫', '羊毛衫', '雪纺衫', '裤子', '高跟鞋', '袜子']
          },
          yAxis: {},
          series: [{
              name: '销量',
              type: 'bar',
              data: [5, 20, 36, 10, 10, 20]
          }]
      });
      ```

    + 注意点：

      + 渲染 echarts 时 要放到 mounted 中
      + 渲染 echarts 的容器必须有宽高

#### 2.3 总结：

+ 类型：
  + 后台管理项目
+ 技术点：
  + vue-cli
    + babel：
    + eslint
    + vue-router
    + vuex
    + vue
  + element-ui
    + form 表单
      + 基本使用
      + 表单验证
    + meuns 组件
    + 布局
    + 容器
    + 表格
    + 分页
    + 确认框
    + 提示框
    + 单选框
    + 下拉框
    + 时间选择器
    + tag
    + 字体组件
    + upload 组件
  + vue-router
    + 导航守卫
      + 使用 token 来完成登录验证
    + 嵌套路由
    + \$router \& $route
      + $router : 路由实例
        + $router.push()
      + $route：路径信息对象（路径选项）
        + path
        + params
        + name
  + axios
    + 将 axios 挂载到 vue 实例中
    + 统一设置基准地址
    + 拦截器
      + 请求拦截器
        + 添加 token
      + 响应拦截器
        + 处理响应的数据
  + vuex
    + state 中保存用户信息
    + mutations 中定义方法来修改 state
  + localstoreage
    + 保存登录信息
  + JSON-bigint
    + 将超出 js 安全的数据进行转换
  +  vue-quill-editor 
    + 富文本编辑框
  + nprogress
    + 进度条
  + 组件的封装
    + 组件的传参
      + 父传子
      + 子传父

### 3.0 项目的打包

+ 需求分析：
  + 一般情况下前端的代码写完之后，要交给特定的人员去发布，而发布不应该直接将庞大的项目源代码发给上线的人员
  + 而是应该将项目进行精减
    + 图片文件压缩
    + css 压缩（去掉空格、换行、注释...）
    + js 压缩
    + 合并 css, js
    + 删除开发阶段才需要使用到的包
    + ...
  + 我们将这些过程叫做打包
+ 步骤
  + npm run build
  + 注意点：
    + 打包时，项目不要启动
    + 打包完成之后，要运行项目，应该放到服务器环境中去运行
+ 结果：
  + 在项目的根目录下生成一个 dist 目录：
    + css：打包之后的 css 样式
      + app.css	项目中所有样式打包后形式成的一个结构
      + vendors.css  第三方包中样式的结构
    + fonts：打包之后的字体文件
    + img: 打包之后的图片
    + js：打包之后的 js 代码
      + app.js	将项目中所有的 js 代码全部打包到了这个文件中
      + app.js.map  app.js 的寻宝图（不要关注）
      + vendors.js  将项目中的第三方包的 js 代码全部打包到了这个文件中
      + vendors.js.map vendors.js 的寻宝图（不要关注）
    + favicon.ico：网站的图标
    + index.html：项目的入口静态文件



+ SPA 的缺陷：

  + 第一次打开页面时，会将项目中的所有资源全部加载

    + 好处：第一次加载完成之后，再打开其它的页面就很快
    + 坏处：第一次将整个项目中的所有资源全部加载，第一次打开速度特别慢

  + 解决方案：

    + 加快页面的打开：

      + 路由的懒加载

        + 将路由加载的写法改一种方式：

          + 将来在打包路由文件中不要打包到 app.js 中

        + 写法：

          + old

            ```
            import Home from './home.vue'
            ```

          + 懒加载

            ```
            cosnt Home = () => import('./home.vue')
            ```

        + 实现原理：

          + 将路由对应的文件不要打包到 app.js 中
          + 将来第一次请求项目时，不需要将资源全部加载
          + 只有当路由被请求时，对应的资源才会被加载